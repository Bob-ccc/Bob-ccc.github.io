(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-81c5d524"],{"68d9":function(t,a,e){},b0c0:function(t,a,e){var i=e("83ab"),s=e("9bf2").f,o=Function.prototype,r=o.toString,n=/^\s*function ([^ (]*)/,c="name";i&&!(c in o)&&s(o,c,{configurable:!0,get:function(){try{return r.call(this).match(n)[1]}catch(t){return""}}})},b727:function(t,a,e){var i=e("0366"),s=e("44ad"),o=e("7b0b"),r=e("50c4"),n=e("65f0"),c=[].push,d=function(t){var a=1==t,e=2==t,d=3==t,l=4==t,u=6==t,v=5==t||u;return function(p,f,h,m){for(var g,C,b=o(p),_=s(b),k=i(f,h,3),y=r(_.length),x=0,w=m||n,D=a?w(p,y):e?w(p,0):void 0;y>x;x++)if((v||x in _)&&(g=_[x],C=k(g,x,b),t))if(a)D[x]=C;else if(C)switch(t){case 3:return!0;case 5:return g;case 6:return x;case 2:c.call(D,g)}else if(l)return!1;return u?-1:d||l?l:D}};t.exports={forEach:d(0),map:d(1),filter:d(2),some:d(3),every:d(4),find:d(5),findIndex:d(6)}},cf2a:function(t,a,e){"use strict";e.r(a);var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"order"},[e("van-nav-bar",{attrs:{fixed:"",title:"订单中心","left-text":"返回","left-arrow":""},on:{"click-left":t.back}}),e("div",{staticClass:"tab-box"},[e("van-tabs",{attrs:{color:"#0C34BA","title-active-color":"#0C34BA"},on:{click:t.toggleTab},model:{value:t.active,callback:function(a){t.active=a},expression:"active"}},t._l(t.tabs,(function(a,i){return e("van-tab",{key:i,attrs:{title:a}},[t.orderDatas[0]?e("div",{staticClass:"order-box"},t._l(t.orderDatas,(function(a,i){return e("div",{key:i,staticClass:"order-item"},[e("div",{staticClass:"order-item-header clearfix"},[e("div",{staticClass:"fl"},[t._v(t._s(a.orderId))]),1==a.status?e("div",{staticClass:"fr"},[t._v("卖家已发货")]):e("div",{staticClass:"fr"},[t._v("交易成功")])]),e("div",{staticClass:"order-item-pros"},t._l(a.products,(function(a,i){return e("div",{key:i,staticClass:"clearfix pro-card"},[e("div",{staticClass:"fl pro-img",on:{click:function(e){return t.goDetails(a.pid)}}},[e("img",{staticClass:"auto-img",attrs:{src:a.smallImg,alt:""}})]),e("div",{staticClass:"card-info fr"},[e("div",{staticClass:"pro-info"},[e("div",{staticClass:"clearfix"},[e("div",{staticClass:"fl pro-name"},[t._v(t._s(a.name))]),e("div",{staticClass:"fl pro-rule"},[t._v(t._s(a.rule))])]),e("div",{staticClass:"pro-enname"},[t._v(t._s(a.enname))])]),e("div",{staticClass:"pro-price"},[e("div",{staticClass:"pro-price-text"},[t._v("￥"+t._s(a.price))]),e("div",{staticClass:"pro-price-count"},[t._v("x"+t._s(a.count))])])])])})),0),e("div",{staticClass:"order-item-foot"},[e("div",{staticClass:"item-total"},[e("div",{staticClass:"item-count-text"},[t._v("共 "+t._s(a.count)+"件商品")]),e("div",{staticClass:"item-total-text"},[t._v(" 合计:￥ "),e("span",[t._v(t._s(a.total))])])]),e("div",{staticClass:"item-date"},[e("div",{},[t._v(t._s(a.date))]),e("div",{},[1==a.status?e("div",{staticClass:"text"},[e("van-button",{attrs:{color:"#0C34BA",plain:"",round:""},on:{click:function(e){return t.confirm(a.orderId)}}},[t._v("确认收货")])],1):e("div",{staticClass:"text-box-tab"},[e("div",{staticClass:"finished fl"},[t._v("已完成")]),e("div",{staticClass:"remove fr"},[e("van-icon",{attrs:{size:"16px",color:"#0C34BA",name:"delete"},on:{click:function(e){return t.showPopup(a.orderId)}}})],1)])])])])])})),0):2==t.active?e("div",[e("van-empty",{attrs:{description:"订单信息为空"}},[e("van-button",{staticClass:"bottom-button",attrs:{round:"",type:"danger"},on:{click:t.goChange}},[t._v("前往收货")])],1)],1):e("div",[e("van-empty",{attrs:{description:"订单信息为空"}},[e("van-button",{staticClass:"bottom-button",attrs:{round:"",type:"danger"},on:{click:t.goMenu}},[t._v("去下单")])],1)],1)])})),1),e("van-popup",{attrs:{round:""},model:{value:t.show,callback:function(a){t.show=a},expression:"show"}},[e("div",{staticClass:"popup-box"},[e("div",{staticClass:"popup-text"},[e("p",[t._v("订单"+t._s(t.deleteOid))]),e("p",[t._v("确定要删除吗")])]),e("div",{staticClass:"btns"},[e("div",{staticClass:"btn btn-cancel",on:{click:t.cancelPopup}},[t._v("取消")]),e("div",{staticClass:"btn btn-confirm",on:{click:t.deleteOrder}},[t._v("确定")])])])])],1)],1)},s=[],o=(e("99af"),e("d81d"),e("b0c0"),e("68d9"),e("2f14")),r={data:function(){return{active:1,orderDatas:[],tabs:["全部","待收货","已完成"],show:!1,deleteOid:""}},created:function(){this.getOrderData(this.active)},beforeRouteLeave:function(t,a,e){"Pay"==t.name&&this.$router.go(-1),e()},methods:{back:function(){this.$router.go(-1)},toggleTab:function(){this.getOrderData(this.active)},goChange:function(){this.active=1,this.getOrderData(this.active)},goMenu:function(){this.$router.push({name:"Menu"})},getOrderData:function(t){var a=this,e=localStorage.getItem("YXCFTK");e&&(this.$toast.loading({message:"加载中...",forbidClick:!0,duration:0,loadingType:"spinner"}),this.axios({method:"GET",url:"/findOrder",params:{appkey:this.appkey,tokenString:e,status:t}}).then((function(t){if(a.$toast.clear(),7e4==t.data.code){var e={};t.data.result.map((function(t){e[t.oid]?(e[t.oid].count+=t.count,e[t.oid].total+=t.count*t.price,e[t.oid].products.push(t)):e[t.oid]={orderId:t.oid,date:o["a"].date(t.createdAt,"yyyy-MM-dd hh:mm:ss"),count:t.count,total:t.count*t.price,products:[t],status:t.status}})),a.orderDatas=[];var i=[];for(var s in e)i.push(e[s]);i.sort((function(t,a){return new Date(a.date).getTime()-new Date(t.date).getTime()}));var r=[],n=[];i.map((function(t){1==t.status?r.push(t):n.push(t)})),a.orderDatas=a.orderDatas.concat(r,n)}})).catch((function(t){a.$toast.clear()})))},goDetails:function(t){this.$router.push({name:"Details",query:{pid:t}})},confirm:function(t){var a=this,e=localStorage.getItem("YXCFTK");if(e){this.$toast.loading({message:"加载中...",forbidClick:!0,duration:0,loadingType:"spinner"});var i=o["a"].queryString({appkey:this.appkey,tokenString:e,oid:t});this.axios({method:"POST",url:"/receive",data:i}).then((function(t){a.$toast.clear(),a.getOrderData(a.active)})).catch((function(t){a.$toast.clear()}))}},showPopup:function(t){this.show=!0,this.deleteOid=t},cancelPopup:function(){this.show=!1},deleteOrder:function(){var t=this,a=localStorage.getItem("YXCFTK");if(a){this.$toast.loading({message:"加载中...",forbidClick:!0,duration:0,loadingType:"spinner"});var e=o["a"].queryString({appkey:this.appkey,tokenString:a,oid:this.deleteOid});this.axios({method:"POST",url:"/removeOrder",data:e}).then((function(a){t.$toast.clear(),t.show=!1,t.getOrderData(t.active)})).catch((function(a){t.$toast.clear()}))}}}},n=r,c=e("2877"),d=Object(c["a"])(n,i,s,!1,null,null,null);a["default"]=d.exports},d81d:function(t,a,e){"use strict";var i=e("23e7"),s=e("b727").map,o=e("1dde"),r=e("ae40"),n=o("map"),c=r("map");i({target:"Array",proto:!0,forced:!n||!c},{map:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}})}}]);
//# sourceMappingURL=chunk-81c5d524.fbc07244.js.map