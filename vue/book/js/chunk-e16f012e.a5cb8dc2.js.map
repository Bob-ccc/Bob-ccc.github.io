{"version":3,"sources":["webpack:///./src/views/mainViews/Home.vue?4211","webpack:///src/views/mainViews/Home.vue","webpack:///./src/views/mainViews/Home.vue?48be","webpack:///./src/views/mainViews/Home.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","on","goSearch","model","value","callback","$$v","active","expression","_l","item","index","key","tab","_v","_s","title","$event","more","setBookData","$set","v","i","shortTitle","booksData","ind","goDetail","_id","cover","latelyFollower","staticRenderFns","name","data","categoriesData","male","female","picture","epub","created","getCategoriesData","methods","$toast","loading","message","forbidClick","duration","loadingType","axios","method","url","getRankData","ids","map","axiosArr","push","all","then","result","ranking","gender","books","sort","b","a","$router","$store","dispatch","id","component"],"mappings":"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","file":"js/chunk-e16f012e.a5cb8dc2.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"home\"},[_c('div',{staticClass:\"search\"},[_c('van-icon',{attrs:{\"size\":\"24px\",\"name\":\"search\"},on:{\"click\":_vm.goSearch}})],1),_c('van-tabs',{staticClass:\"tabs-box\",attrs:{\"sticky\":\"\",\"swipe-threshold\":\"3\",\"animated\":\"\",\"swipeable\":\"\",\"route\":\"\",\"title-inactive-color\":\"#999\"},model:{value:(_vm.active),callback:function ($$v) {_vm.active=$$v},expression:\"active\"}},_vm._l((_vm.categoriesData),function(item,index){return _c('van-tab',{key:index,attrs:{\"title\":item.tab}},[_c('div',{staticClass:\"content\"},[_c('div',{staticClass:\"tuijian\"},[_c('h2',[_vm._v(_vm._s(item.title)+\" \"),_c('span',{on:{\"click\":function($event){return _vm.more(index)}}},[_vm._v(\"查看更多\"),_c('van-icon',{attrs:{\"name\":\"arrow\"}})],1)]),_c('div',{staticClass:\"ranking-box clearfix\"},[_c('van-tabs',{staticClass:\"ranking-tabs\",on:{\"click\":function($event){return _vm.setBookData(index)}},model:{value:(item.active),callback:function ($$v) {_vm.$set(item, \"active\", $$v)},expression:\"item.active\"}},_vm._l((item.data),function(v,i){return _c('van-tab',{key:i,attrs:{\"title\":v.shortTitle}},[_c('div',{staticClass:\"books-box\"},_vm._l((_vm.booksData[index]),function(value,ind){return _c('div',{key:ind,staticClass:\"book clearfix\",on:{\"click\":function($event){return _vm.goDetail(value._id)}}},[_c('div',{staticClass:\"book-img fl\"},[_c('img',{staticClass:\"auto-img\",attrs:{\"src\":value.cover,\"alt\":\"\"}})]),_c('div',{staticClass:\"book-num fl\"},[_vm._v(_vm._s(ind+1))]),_c('div',{staticClass:\"book-text fl\"},[_c('div',{staticClass:\"book-title\"},[_vm._v(_vm._s(value.title))]),_c('div',{staticClass:\"book-hot\"},[_c('van-icon',{attrs:{\"name\":\"fire-o\"}}),_vm._v(\" \"+_vm._s(value.latelyFollower)+\" \")],1)])])}),0)])}),1)],1)])])])}),1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"home\">\n    <div class=\"search\">\n      <van-icon size=\"24px\" @click=\"goSearch\" name=\"search\" />\n    </div>\n    <van-tabs\n      class=\"tabs-box\"\n      v-model=\"active\"\n      sticky\n      swipe-threshold=\"3\"\n      animated\n      swipeable\n      route\n      title-inactive-color=\"#999\"\n    >\n      <van-tab v-for=\"(item,index) in categoriesData\" :key=\"index\" :title=\"item.tab\">\n        <div class=\"content\">\n          <div class=\"tuijian\">\n            <h2>{{item.title}} <span @click=\"more(index)\">查看更多<van-icon name=\"arrow\" /></span> </h2>\n            <div class=\"ranking-box clearfix\">\n              <van-tabs v-model=\"item.active\" @click=\"setBookData(index)\" class=\"ranking-tabs\">\n                <van-tab v-for=\"(v,i) in item.data\" :key=\"i\" :title=\"v.shortTitle\">\n                  <div class=\"books-box\">\n                    <div\n                      class=\"book clearfix\"\n                      v-for=\"(value,ind) in booksData[index]\"\n                      :key=\"ind\"\n                      @click=\"goDetail(value._id)\"\n                    >\n                      <div class=\"book-img fl\">\n                        <img class=\"auto-img\" :src=\"value.cover\" alt />\n                      </div>\n                      <div class=\"book-num fl\">{{ind+1}}</div>\n                      <div class=\"book-text fl\">\n                        <div class=\"book-title\">{{value.title}}</div>\n                        <div class=\"book-hot\">\n                          <van-icon name=\"fire-o\" />\n                          {{value.latelyFollower}}\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </van-tab>\n              </van-tabs>\n            </div>\n          </div>\n        </div>\n      </van-tab>\n    </van-tabs>\n  </div>\n</template>\n\n<script>\nimport \"../../assets/less/home.less\";\nexport default {\n  name: \"Home\",\n  data() {\n    return {\n      active: 0,\n      // 排行榜数据\n      categoriesData: {\n        male: { tab: \"男生\", title: \"排行榜\", active: 0, data: [] },\n        female: { tab: \"女生\", title: \"排行榜\", active: 0, data: [] },\n        picture: { tab: \"漫画\", title: \"排行榜\", active: 0, data: [] },\n        epub: { tab: \"出版\", title: \"排行榜\", active: 0, data: [] },\n      },\n      // 展示区域书籍列表\n      booksData: {\n        epub: [],\n        female: [],\n        male: [],\n        picture: [],\n      },\n    };\n  },\n  created() {\n    this.getCategoriesData();\n  },\n  methods: {\n    // 获取分类数据\n    getCategoriesData() {\n      this.$toast.loading({\n        message: \"加载中...\",\n        forbidClick: true,\n        duration: 0,\n        loadingType: \"spinner\",\n      });\n\n      this.axios({\n        method: \"GET\",\n        url: \"/rank-category\",\n      })\n        .then((result) => {\n          this.$toast.clear();\n          for (let key in this.categoriesData) {\n            this.categoriesData[key].data = result.data[key].splice(0, 4);\n          }\n          this.setBookData();\n\n          // console.log(\"categoriesData==>\", this.categoriesData);\n          // console.log(\"booksData==>\", this.booksData);\n        })\n        .catch((err) => {\n          this.$toast.clear();\n        });\n    },\n\n    // 返回promise对象数组\n    getRankData(ids) {\n      let axiosArr = [];\n      ids.map((v) => {\n        axiosArr.push(\n          this.axios({\n            method: \"GET\",\n            url: \"/rank/\" + v,\n          })\n          // this.getIdData(v)\n          );\n      });\n      // console.log(axiosArr);\n      return this.axios.all(axiosArr);\n    },\n\n    // 点击排行榜设置书籍列表\n    setBookData() {\n      let ids = [];\n      for (let key in this.categoriesData) {\n        ids.push(\n          this.categoriesData[key].data[this.categoriesData[key].active]._id\n        );\n      }\n      this.$toast.loading({\n        message: \"加载中...\",\n        forbidClick: true,\n        duration: 0,\n        loadingType: \"spinner\",\n      });\n      // 防止因为网络问题请求时间过长，提前停止加载动画\n      // setTimeout(() => {\n      //   this.$toast.clear();\n      // }, 500);\n      this.getRankData(ids).then((result) => {\n        this.$toast.clear();\n        for (let key in this.booksData) {\n          result.map((v) => {\n            if (v.data.ranking.gender == key) {\n              // 人气降序\n              v.data.ranking.books.sort((a, b) => {\n                return b.latelyFollower - a.latelyFollower;\n              });\n              this.booksData[key] = v.data.ranking.books.splice(0, 8);\n              this.booksData[key].map((v) => [\n                (v.cover = unescape(v.cover.slice(7))),\n              ]);\n            }\n          });\n        }\n      });\n    },\n\n    // 点击查看更多\n    more(item){\n      // console.log(item)\n      this.$router.push({name:\"Rank\",query:{title:item}})\n    },\n\n    // 点击书籍，根据书籍id获取书籍详情，前往书籍详情页面\n    goDetail(id) {\n      this.$store.dispatch(\"detailStore/setBookIdListById\", id);\n      this.$toast.loading({\n        message: \"加载中...\",\n        forbidClick: true,\n        duration: 0,\n        loadingType: \"spinner\",\n      });\n      this.axios\n        .all([\n          this.axios({\n            method: \"GET\",\n            url: \"/book-info/\" + id,\n          }),\n          this.axios({\n            method: \"GET\",\n            url: \"/book-sources?view=summary&book=\" + id,\n          }),\n        ])\n        .then((result) => {\n          this.$toast.clear();\n          this.$store.dispatch(\"detailStore/setBookDetail\", result[0].data);\n          this.$store.dispatch(\n            \"detailStore/setBookOriginIdListById\",\n            result[1].data[0]._id\n          );\n          this.$router.push({ name: \"Detail\" });\n        })\n        .catch((err) => {\n          this.$toast.clear();\n        });\n    },\n\n\n\n    // 前往搜索页面\n    goSearch(){\n      this.$router.push({name:\"Search\"})\n    }\n\n\n    \n  },\n};\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Home.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Home.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Home.vue?vue&type=template&id=661b4128&\"\nimport script from \"./Home.vue?vue&type=script&lang=js&\"\nexport * from \"./Home.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}